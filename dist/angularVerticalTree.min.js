angular.module("drg.angularVerticalTree",[]).directive("verticalTree",["$compile","$templateCache","$timeout",function(e,r,t){return{restrict:"EA",scope:{items:"<treeItems",treeOpts:"<",open:"&onOpen",select:"&onSelect"},controller:"vTreeCtrl",compile:function(n){var a=n.find("vertical-tree-breadcrumb"),l=n.find("vertical-tree-leaf");return a=a&&a.length>0?a.html():"",l=l&&l.length>0?l.html():"",n.empty(),{pre:function(t,n){t.templates={breadcrumb:"drg/vTreeBreadcrumb"+t.$id+".tpl.html",leaf:"drg/vTreeLeaf"+t.$id+".tpl.html"},r.put(t.templates.breadcrumb,a),r.put(t.templates.leaf,l),n.prepend(e(r.get("drg/angularVerticalTree.tpl.html"))(t))},post:function(e,r){function n(){t(function(){var e=document.querySelectorAll(".v-tree-breadcrumb-container")[0],r=document.querySelectorAll(".v-tree-container")[0],t=document.querySelectorAll(".v-tree-branch")[0];r.offsetHeight-e.offsetHeight;t.style.height="calc(100% - "+e.offsetHeight+"px)"})}n(),e.updateBranchHeight=n}}}}}]).controller("vTreeCtrl",["$scope",function(e){function r(e,t){return angular.forEach(t,function(t,n){angular.isObject(t)?e[n]?e[n]=r(angular.isObject(e[n])?e[n]:{},t):e[n]=angular.copy(t):e[n]=t}),e}function t(){var r=e.breadcrumbs[e.breadcrumbs.length-1];if(!r)return[];var t=r[e.opts.children];return t?t.filter(e.opts.isLeaf):[]}function n(r){e.breadcrumbs.push(r),e.leaves=t(),e.updateBranchHeight(),e.$emit("verticalTree.openFolder",r),e.open&&e.open({folder:r})}function a(r){e.$emit("verticalTree.selectItem",r),e.select&&e.select({item:r})}e.opts=r({root:"Root",label:"label",children:"children",classes:{container:"panel panel-default",breadcrumb:"list-group-item","breadcrumb-container":"panel-heading list-group",branch:"list-group",leaf:"list-group-item"},emptyMessage:"",isLeaf:function(){return!0},isFolder:function(r){return r[e.opts.children]&&r[e.opts.children].length>0}},e.treeOpts);var l={};angular.isObject(e.opts.root)?l=angular.copy(e.opts.root):l[e.opts.label]=e.opts.root,Object.defineProperty(l,e.opts.children,{get:function(){return e.items}}),e.breadcrumbs=[l],e.leaves=t(),e.leafClickHandler=function(r){e.opts.isFolder(r)?n(r):e.opts.isLeaf(r)&&a(r)},e.breadcrumbClickHandler=function(r){for(var t=0;t<e.breadcrumbs.length;t++)if(angular.equals(e.breadcrumbs[t],r)){e.breadcrumbs.splice(t,e.breadcrumbs.length-t),n(r);break}}}]),angular.module("drg.angularVerticalTree").run(["$templateCache",function(e){e.put("drg/angularVerticalTree.tpl.html",'<!-- .panel by default -->\r\n<div class="v-tree-container" ng-class="opts.classes.container" >\r\n\r\n    <!-- .panel-heading by default -->\r\n    <div class="v-tree-breadcrumb-container" ng-class="opts.classes.breadcrumb-container">\r\n        <a class="v-tree-breadcrumb"\r\n           href="javascript:;"\r\n           ng-class="opts.classes.breadcrumb"\r\n           ng-click="breadcrumbClickHandler(breadcrumb)"\r\n           ng-include="templates.breadcrumb"\r\n           ng-repeat="breadcrumb in breadcrumbs"\r\n           style="display: block;">\r\n        </a>\r\n    </div>\r\n\r\n    <!-- .list-group by default -->\r\n    <div class="v-tree-branch" ng-class="opts.classes.branch">\r\n        <!-- .list-group-item by default -->\r\n        <a class="v-tree-leaf"\r\n           href="javascript:;"\r\n           ng-class="opts.classes.leaf"\r\n           ng-click="leafClickHandler(leaf)"\r\n           ng-include="templates.leaf"\r\n           ng-repeat="leaf in leaves">\r\n        </a>\r\n        <p class="v-tree-empty" ng-if="!leaves || !leaves.length" ng-bind="opts.emptyMessage"></p>\r\n    </div>\r\n\r\n</div>\r\n')}]);